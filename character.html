<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>马丁内斯死在惊奇馆</title>
    <meta http-equiv=“Pragma” content="no-cache">
    <meta http-equiv=“Expires” content="-1">
    <meta http-equiv=“CACHE-CONTROL” content="NO-CACHE">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,500;1,700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>

    <link rel="stylesheet" href="https://unpkg.com/viewerjs/dist/viewer.css" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container mx-auto px-6 py-6">
        <div>
            <legend class="text-2xl font-bold text-gray-900">选择角色</legend>

            <div class="mt-4 grid grid-cols-1 gap-y-6 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-x-4" id="characters">
            </div>
        </div>
    </div>

    <script>
        const characters = {
            1: {
                id: 1,
                key1: "lovers",
                key2: "caroline",
                name1: "恋人",
                name2: "卡罗琳",
                script1: "stage-1/lovers.pdf",
                script2: "stage-2/1-caroline.pdf",
                password: "520"
            },
            2: {
                id: 2,
                key1: "tower",
                key2: "eureka",
                name1: "塔",
                name2: "尤里卡",
                script1: "stage-1/tower.pdf",
                script2: "stage-2/2-eureka.pdf",
                password: "fallen"
            },
            3: {
                id: 3,
                key1: "wheel-of-fortune",
                key2: "joanna",
                name1: "命运之轮",
                name2: "乔安娜",
                script1: "stage-1/wheel-of-fortune.pdf",
                script2: "stage-2/3-joanna.pdf",
                password: "scroll"
            },
            4: {
                id: 4,
                key1: "world",
                key2: "will",
                name1: "世界",
                name2: "威尔",
                script1: "stage-1/world.pdf",
                script2: "stage-2/4-will.pdf",
                password: "minecraft"
            },
            5: {
                id: 5,
                key1: "hangman",
                key2: "justin",
                name1: "倒吊人",
                name2: "贾斯汀",
                script1: "stage-1/hangman.pdf",
                script2: "stage-2/5-justin.pdf",
                password: "spelling"
            },
            6: {
                id: 6,
                key1: "fool",
                key2: "mayetta",
                name1: "愚者",
                name2: "梅耶塔",
                script1: "stage-1/fool.pdf",
                script2: "stage-2/6-mayetta.pdf",
                password: "innocent"
            }
        };

        const characters_selector = $("#characters");

        // for each character
        for (const [key, value] of Object.entries(characters)) {
            let id = key;
            let character = value.key1;
            let name = value.name1;

            // create a new div
            characters_selector.append(`
                <label class="character-selector relative bg-white border rounded-lg shadow-sm p-4 flex cursor-pointer focus:outline-none" character-id="${id}">
                    <input type="radio" name="project-type" value="" class="sr-only"
                        aria-labelledby="project-type-1-label"
                        aria-describedby="project-type-1-description-0 project-type-1-description-1">
                    <div class="flex-1 flex">
                        <div class="flex flex-col">
                            <span id="project-type-1-label" class="block text-lg font-bold text-gray-900 mb-4">${name}</span>
                            <img src="visual/${id}-${character}.jpg" />
                        </div>
                    </div>
                    <div class="absolute -inset-px rounded-lg border-2 pointer-events-none" aria-hidden="true"></div>
                </label>
            `);
        }

        let selectCharacter = function(id) {
            // prompt for password
            let password = prompt("角色访问密码");
            let character = characters[id];
            character.key = id;

            if(password === null) {
                return;
            }else if (password == character.password || password === "000") {
                // redirect to character.html
                window.localStorage.setItem("character", JSON.stringify(character));
                window.location.href = "bench.html?" + Date.now();
            } else {
                // else alert
                alert("角色密码错误");
            }
        }

        $(".character-selector").click(function() {
            let id = $(this).attr("character-id");
            selectCharacter(id);
            return false;
        });
    </script>
</body>

</html>